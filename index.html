<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luther : L'Exploration Interactive</title>
    <!-- Ligne pour l'icône de l'onglet (favicon) -->
    <link rel="icon" type="image/png" href="nibiru logo rap site.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
            color: #D1D5DB; /* text-gray-300 */
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #3B82F6; /* blue-500 */
            transition: width 0.3s;
        }
        .nav-link.active, .nav-link:hover {
            color: #3B82F6;
        }
        .nav-link.active::after, .nav-link:hover::after {
            width: 100%;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -1px;
            top: 2rem;
            width: 2px;
            height: calc(100% - 2rem);
            background-color: #374151; /* gray-700 */
        }
        .timeline-item:last-child::before {
            display: none;
        }
        .timeline-dot {
            position: absolute;
            left: -8px;
            top: 2rem;
            width: 18px;
            height: 18px;
            background-color: #111827;
            border: 3px solid #3B82F6; /* blue-500 */
            border-radius: 50%;
            z-index: 10;
        }
        .card-flip {
            perspective: 1000px;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card-flip:hover .card-inner:not(.is-flipped) {
            transform: rotateY(180deg);
        }
        .card-inner.is-flipped {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 0.75rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0.75rem;
        }
        .card-back {
            transform: rotateY(180deg);
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 60vh;
            max-height: 500px;
            width: 100%;
            max-width: 600px;
        }
        .loader {
            border: 2px solid #4B5563; /* gray-600 */
            border-top: 2px solid #3B82F6; /* blue-500 */
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .gemini-btn {
            background-image: linear-gradient(to right, #4F46E5, #3B82F6);
        }
        #chat-widget.hidden, #chat-container.hidden, #username-modal.hidden {
            display: none;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-gray-900/80 backdrop-blur-md sticky top-0 z-50 shadow-lg shadow-black/20">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-black tracking-tighter text-white">LUTHER</h1>
            <div id="nav-links" class="hidden md:flex items-center space-x-8 text-sm font-semibold uppercase tracking-wider text-gray-400">
                <a href="#introduction" data-section="introduction" class="nav-link active">Introduction</a>
                <a href="#parcours" data-section="parcours" class="nav-link">Parcours</a>
                <a href="#univers" data-section="univers" class="nav-link">Univers</a>
                <a href="#sonorites" data-section="sonorites" class="nav-link">Sonorités</a>
            </div>
             <button id="mobile-menu-button" class="md:hidden text-gray-200">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden bg-gray-800 p-4">
             <a href="#introduction" data-section="introduction" class="block py-2 text-center nav-link-mobile">Introduction</a>
             <a href="#parcours" data-section="parcours" class="block py-2 text-center nav-link-mobile">Parcours</a>
             <a href="#univers" data-section="univers" class="block py-2 text-center nav-link-mobile">Univers</a>
             <a href="#sonorites" data-section="sonorites" class="block py-2 text-center nav-link-mobile">Sonorités</a>
        </div>
    </header>
    
    <div id="firebaseConfigBanner" class="container mx-auto px-6 pt-6">
        <div class="bg-purple-900/50 border-l-4 border-purple-500 text-purple-300 p-4 rounded-md" role="alert">
            <p class="font-bold">Action requise pour le Chat</p>
            <p>Pour activer le chat, vous devez fournir votre configuration Firebase. Suivez le guide pour obtenir votre configuration gratuite.</p>
            <div class="mt-3 flex flex-col gap-2">
                <textarea id="firebaseConfigInput" placeholder='Collez votre objet de configuration Firebase ici (ex: { apiKey: "...", ... })' class="p-2 rounded-md border border-gray-600 w-full bg-gray-800 text-gray-200 placeholder-gray-500 font-mono text-xs" rows="4"></textarea>
                <button id="saveFirebaseConfigBtn" class="bg-purple-600 text-white px-4 py-2 rounded-md font-semibold hover:bg-purple-700 transition-colors flex items-center justify-center w-48">Activer le Chat</button>
                <span id="firebaseConfigStatus" class="font-semibold"></span>
            </div>
        </div>
    </div>

    <main class="container mx-auto px-6 py-8 md:py-16">
        <!-- Contenu principal du site -->
        <section id="introduction" class="content-section active"></section>
        <section id="parcours" class="content-section"></section>
        <section id="univers" class="content-section"></section>
        <section id="sonorites" class="content-section"></section>
    </main>

    <footer class="text-center py-8 mt-16 border-t border-gray-800">
        <p class="text-sm text-gray-500">Une exploration interactive basée sur le rapport "Luther : Portrait d'un Garçon de la New Wave".</p>
    </footer>

    <!-- Chat Widget -->
    <div id="chat-widget" class="fixed bottom-5 right-5 z-50 cursor-pointer hidden">
        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center shadow-lg hover:bg-blue-700 transition-colors">
             <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
        </div>
    </div>

    <!-- Chat Container -->
    <div id="chat-container" class="fixed bottom-24 right-5 w-80 h-96 bg-gray-800 rounded-lg shadow-2xl flex flex-col hidden z-50 border border-gray-700">
        <div class="p-3 bg-gray-900 rounded-t-lg flex justify-between items-center">
            <h3 class="font-bold text-white">Chat en direct</h3>
            <button id="close-chat-btn" class="text-gray-400 hover:text-white">&times;</button>
        </div>
        <div id="chat-messages" class="flex-1 p-3 overflow-y-auto space-y-2"></div>
        <form id="chat-form" class="p-3 border-t border-gray-700 flex gap-2">
            <input id="chat-input" type="text" placeholder="Écrivez un message..." class="flex-1 p-2 bg-gray-700 rounded-md text-gray-200 placeholder-gray-500 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button type="submit" class="bg-blue-600 px-4 rounded-md text-white font-semibold hover:bg-blue-700">Envoyer</button>
        </form>
    </div>

    <!-- Username Modal -->
    <div id="username-modal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-2xl w-80 border border-gray-700">
             <h3 class="font-bold text-white text-lg mb-4">Définir un pseudo</h3>
             <form id="username-form" class="flex flex-col gap-3">
                 <input id="username-input" type="text" placeholder="Entrez votre pseudo" maxlength="15" class="p-2 bg-gray-700 rounded-md text-gray-200 placeholder-gray-500 border border-gray-600" required>
                 <button type="submit" class="bg-blue-600 p-2 rounded-md text-white font-semibold hover:bg-blue-700">Commencer à chatter</button>
             </form>
        </div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, onSnapshot, serverTimestamp, orderBy, deleteDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('introduction').innerHTML = `
                <div class="text-center max-w-4xl mx-auto">
                    <h2 class="text-4xl md:text-6xl font-black tracking-tighter text-white leading-tight">L'ÉNIGME LUTHER</h2>
                    <p class="mt-4 text-lg md:text-xl text-gray-400">Une histoire sans paroles, où la musique est l'unique biographie autorisée.</p>
                    <div class="mt-12 bg-gray-800/50 p-8 rounded-xl shadow-lg border border-gray-700">
                        <p class="text-2xl md:text-3xl font-semibold italic text-blue-400">« Pose pas d'questions sur ma vie, t'as qu'à écouter mes sons »</p>
                        <p class="mt-2 text-sm text-gray-500">- Pk tu m'apl?</p>
                    </div>
                    <div class="mt-12 text-left text-base text-gray-300 leading-relaxed space-y-4">
                        <p>Cette application interactive vous invite à plonger dans l'univers de Luther, un artiste qui a fait du mystère sa signature. En refusant systématiquement les interviews, il force son public à une analyse profonde de son œuvre. Chaque morceau, chaque punchline, chaque référence est un fragment de son histoire.</p>
                    </div>
                </div>`;
            document.getElementById('parcours').innerHTML = `
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-4xl md:text-5xl font-black tracking-tighter text-white">Parcours</h2>
                    <p class="mt-4 text-lg text-gray-400">Une chronologie interactive de l'ascension de Luther. Cliquez sur les points pour explorer.</p>
                </div>
                <div class="mt-16 max-w-5xl mx-auto">
                    <div id="timeline" class="relative border-l-2 border-gray-700 ml-4 py-4"></div>
                    <div id="timeline-details" class="mt-8"></div>
                </div>`;
            document.getElementById('univers').innerHTML = `
                 <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-4xl md:text-5xl font-black tracking-tighter text-white">L'Univers Décodé</h2>
                    <p class="mt-4 text-lg text-gray-400">Le langage de Luther est un labyrinthe de références. Retournez une carte pour découvrir son explication.</p>
                </div>
                <div class="my-12 flex justify-center flex-wrap gap-2 md:gap-4">
                    <button class="filter-btn px-4 py-2 rounded-md font-semibold transition-colors duration-200" data-filter="all">Tous</button>
                    <button class="filter-btn px-4 py-2 rounded-md font-semibold transition-colors duration-200" data-filter="Jeu Vidéo">Jeu Vidéo</button>
                    <button class="filter-btn px-4 py-2 rounded-md font-semibold transition-colors duration-200" data-filter="Manga/Anime">Manga/Anime</button>
                    <button class="filter-btn px-4 py-2 rounded-md font-semibold transition-colors duration-200" data-filter="Pop Culture">Pop Culture</button>
                </div>
                <div id="references-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6"></div>`;
            document.getElementById('sonorites').innerHTML = `
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-4xl md:text-5xl font-black tracking-tighter text-white">Évolution Sonore</h2>
                    <p class="mt-4 text-lg text-gray-400">De la plugg music atmosphérique qui a défini la new wave à des productions électroniques radicales, le son de Luther est en perpétuelle mutation.</p>
                </div>
                <div class="mt-16 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-2xl font-bold text-blue-400">La Plugg Music</h3>
                            <p class="mt-2 text-gray-300 leading-relaxed">Au coeur de la new wave, la plugg est un sous-genre de la trap caractérisé par une atmosphère rêveuse, des harmonies jazzy et des rythmiques éparses. Luther en a été l'un des pionniers en France, utilisant ses sonorités planantes comme véhicule parfait pour ses thèmes introspectifs et mélancoliques, notamment sur l'album <span class="font-bold text-white">GARÇON</span>.</p>
                        </div>
                         <div>
                            <h3 class="text-2xl font-bold text-blue-400">Le Virage Électronique</h3>
                            <p class="mt-2 text-gray-300 leading-relaxed">Avec <span class="font-bold text-white">EXIT</span>, Luther opère une rupture nette. Il délaisse la plugg pour des productions beaucoup plus pop, électroniques et "robotiques". Ce virage sonore n'est pas qu'une expérimentation : c'est un acte de "sortie", une fuite délibérée des attentes et de la case artistique que son succès a créées.</p>
                        </div>
                    </div>
                    <div>
                         <div class="chart-container">
                            <canvas id="styleChart"></canvas>
                        </div>
                        <p class="text-center text-sm text-gray-500 mt-4">Comparaison des palettes sonores entre GARÇON (2022) et EXIT (2024).</p>
                    </div>
                </div>`;

            let db;
            let messagesCol;
            let username = localStorage.getItem('luther_chat_username');
            
            const firebaseConfigInput = document.getElementById('firebaseConfigInput');
            const saveFirebaseConfigBtn = document.getElementById('saveFirebaseConfigBtn');
            const firebaseConfigStatus = document.getElementById('firebaseConfigStatus');
            const firebaseConfigBanner = document.getElementById('firebaseConfigBanner');

            const chatWidget = document.getElementById('chat-widget');
            const chatContainer = document.getElementById('chat-container');
            const closeChatBtn = document.getElementById('close-chat-btn');
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');

            const usernameModal = document.getElementById('username-modal');
            const usernameForm = document.getElementById('username-form');
            const usernameInput = document.getElementById('username-input');

            saveFirebaseConfigBtn.addEventListener('click', async () => {
                const configText = firebaseConfigInput.value.trim();
                if (!configText) {
                    firebaseConfigStatus.textContent = '❌ Config requise';
                    return;
                }

                try {
                    const firebaseConfig = JSON.parse(configText);
                    const app = initializeApp(firebaseConfig);
                    const auth = getAuth(app);
                    db = getFirestore(app);
                    await signInAnonymously(auth);
                    
                    messagesCol = collection(db, "luther_chat_messages");
                    initChat();

                    firebaseConfigBanner.style.transition = 'opacity 0.5s ease-out';
                    firebaseConfigBanner.style.opacity = '0';
                    setTimeout(() => firebaseConfigBanner.style.display = 'none', 500);

                } catch (e) {
                    console.error("Firebase initialization failed:", e);
                    firebaseConfigStatus.textContent = '❌ Config invalide';
                }
            });
            
            const bannedWords = ['merde', 'con', 'salope', 'putain', 'fdp']; 
            
            function profanityFilter(text) {
                let cleanText = text;
                bannedWords.forEach(word => {
                    const regex = new RegExp(`\\b${word}\\b`, 'gi');
                    cleanText = cleanText.replace(regex, '***');
                });
                return cleanText;
            }
            
            function initChat() {
                chatWidget.classList.remove('hidden');

                if (!username) {
                    usernameModal.classList.remove('hidden');
                }
                
                chatWidget.addEventListener('click', () => {
                    chatContainer.classList.remove('hidden');
                    chatWidget.classList.add('hidden');
                });

                closeChatBtn.addEventListener('click', () => {
                    chatContainer.classList.add('hidden');
                    chatWidget.classList.remove('hidden');
                });

                usernameForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const newUsername = usernameInput.value.trim();
                    if (newUsername) {
                        username = newUsername;
                        localStorage.setItem('luther_chat_username', username);
                        usernameModal.classList.add('hidden');
                    }
                });

                chatForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const text = chatInput.value.trim();
                    if (text && username) {
                        const cleanText = profanityFilter(text);
                        try {
                            await addDoc(messagesCol, {
                                text: cleanText,
                                username: username,
                                createdAt: serverTimestamp()
                            });
                            chatInput.value = '';
                        } catch (error) {
                            console.error("Error sending message: ", error);
                        }
                    }
                });

                const thirtyMinutesAgo = new Date(Date.now() - 30 * 60 * 1000);
                const q = query(messagesCol, where("createdAt", ">=", thirtyMinutesAgo), orderBy("createdAt", "desc"));
                
                onSnapshot(q, (snapshot) => {
                    chatMessages.innerHTML = '';
                    const messages = [];
                    snapshot.forEach(doc => messages.push(doc.data()));
                    
                    messages.reverse().forEach(data => {
                        const messageEl = document.createElement('div');
                        messageEl.innerHTML = `<span class="font-bold text-blue-400">${data.username || 'Anonyme'}:</span> <span class="text-gray-300">${data.text}</span>`;
                        chatMessages.appendChild(messageEl);
                    });
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                });

                setInterval(async () => {
                    const expiryTime = new Date(Date.now() - 30 * 60 * 1000);
                    const oldMessagesQuery = query(messagesCol, where("createdAt", "<", expiryTime));
                    const snapshot = await getDocs(oldMessagesQuery);
                    snapshot.forEach(doc => deleteDoc(doc.ref));
                }, 5 * 60 * 1000); 
            }

            const sections = document.querySelectorAll('.content-section');
            const navLinks = document.querySelectorAll('#nav-links .nav-link');
            const mobileNavLinks = document.querySelectorAll('#mobile-menu .nav-link-mobile');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            const timelineData = [
                { year: '2020', title: 'Trame', type: 'Album SoundCloud', description: "Premières fondations de son univers. Un projet de 'bedroom producer' qui mêle trap, cloud rap et surtout plugg. Contient une collaboration notable avec BU\$HI." },
                { year: '2021', title: 'IDD', type: 'EP SoundCloud', description: "Confirmation de son identité artistique. Le morceau 'Yuto & Yugi' établit la dualité comme un pilier fondamental de son œuvre, une thématique qui irriguera tous ses projets futurs." },
                { year: '2022', title: 'GARÇON', type: 'Album Studio (Sublime)', description: "Le projet de la consécration, certifié disque d'or. Une exploration de la nuance et un rejet de la pensée binaire, fortement inspiré par la morale du jeu vidéo Undertale. Luther devient la figure de proue de la new wave." },
                { year: '2023', title: 'AMI', type: 'EP (Sublime)', description: "Un EP de 3 titres qui sert de pont conceptuel. La référence à l'antagoniste masqué du manga '20th Century Boys' renforce son propre mystère et explore les tourments de la célébrité naissante." },
                { year: '2024', title: 'EXIT', type: 'Album Studio (Sublime)', description: "Une rupture stylistique radicale. L'album abandonne la plugg pour des sonorités pop et électroniques. Thématiquement, il explore la désillusion et le besoin de s'échapper ('exit') des attentes." }
            ];

            const referencesData = [
                { name: 'Papyrus & Toriel', category: 'Jeu Vidéo', source: 'Undertale', explanation: "Symboles de la nuance et de la dualité bienveillante. Papyrus veut capturer le joueur mais désire son amitié. Toriel est une figure protectrice. Luther les utilise pour explorer la complexité des sentiments.", punchline: "« J'suis amoureux de c'que j'déteste, j'suis comme Papyrus »" },
                { name: 'Gorons', category: 'Jeu Vidéo', source: 'The Legend of Zelda', explanation: "Ces créatures mangeuses de pierres aux yeux rouges sont une métaphore élaborée pour la consommation de cannabis.", punchline: "Titre du morceau : « ROUGE GORON »" },
                { name: 'Toplaner', category: 'Jeu Vidéo', source: 'League of Legends', explanation: "Rôle de joueur souvent isolé sur la carte. Luther l'utilise comme métaphore de son individualisme et de son indépendance artistique.", punchline: "« J'ai l'mental à un toplaner »" },
                { name: 'Silverfish', category: 'Jeu Vidéo', source: 'Minecraft', explanation: "Créatures hostiles cachées dans des blocs. Évoque un sentiment d'être piégé, caché et potentiellement nuisible dans son propre environnement.", punchline: "« J'suis un silverfish dans un bloc de mossy »" },
                { name: 'Yuto & Yugi', category: 'Manga/Anime', source: 'Yu-Gi-Oh!', explanation: "Le protagoniste Yugi partage son corps avec l'esprit d'un pharaon. La référence fondatrice du thème de la dualité chez Luther.", punchline: "« Deux personnalités en une seule tête »" },
                { name: 'Ami', category: 'Manga/Anime', source: '20th Century Boys', explanation: "L'antagoniste est un leader de secte masqué et énigmatique. Luther joue avec cette image pour son EP, renforçant son propre anonymat et son statut de figure culte.", punchline: "Titre de l'EP : « AMI »" },
                { name: 'Carte du Maraudeur', category: 'Pop Culture', source: 'Harry Potter', explanation: "Il détourne la célèbre formule « Je jure solennellement que mes intentions sont mauvaises » pour exprimer une conscience cynique du potentiel corrupteur du pouvoir.", punchline: "« J'veux l'pouvoir, j'jure qu'les intentions sont mauvaises »" },
                { name: 'Pierre-Feuille-Ciseaux', category: 'Pop Culture', source: 'Jeu universel', explanation: "Métaphore simple et puissante du regret, de la jeunesse et du sentiment d'avoir fait le mauvais choix face aux aléas de la vie.", punchline: "« La vie a fait feuille comme un con j'ai fait pierre »" },
            ];
            
            function switchSection(sectionId) {
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                document.getElementById(sectionId).classList.add('active');
                document.querySelectorAll('#nav-links .nav-link').forEach(l => l.classList.toggle('active', l.dataset.section === sectionId));
            }
            
            function setupNav(links) {
                links.forEach(link => {
                    link.addEventListener('click', e => {
                        e.preventDefault();
                        switchSection(link.dataset.section);
                        if (!document.getElementById('mobile-menu').classList.contains('hidden')) {
                            document.getElementById('mobile-menu').classList.add('hidden');
                        }
                    });
                });
            }
            
            setupNav(document.querySelectorAll('#nav-links .nav-link'));
            setupNav(document.querySelectorAll('#mobile-menu .nav-link-mobile'));
            
            document.getElementById('mobile-menu-button').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });
            
            const timelineContainer = document.getElementById('timeline');
            const timelineDetailsContainer = document.getElementById('timeline-details');
            timelineData.forEach((item, index) => {
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item relative pl-8 pb-12 cursor-pointer';
                timelineItem.innerHTML = `<div class="timeline-dot"></div><p class="text-sm text-blue-500 font-semibold">${item.year}</p><h3 class="text-xl font-bold text-gray-100">${item.title}</h3><p class="text-md text-gray-400">${item.type}</p>`;
                timelineItem.addEventListener('click', () => {
                    timelineDetailsContainer.innerHTML = `<div class="bg-gray-800 p-6 rounded-lg shadow-md border border-gray-700"><h3 class="text-2xl font-bold text-white">${item.title} (${item.year})</h3><p class="mt-2 text-gray-300">${item.description}</p></div>`;
                });
                timelineContainer.appendChild(timelineItem);
            });
            if (timelineContainer.firstElementChild) timelineContainer.firstElementChild.click();
            
            const referencesGrid = document.getElementById('references-grid');
            const filterBtns = document.querySelectorAll('.filter-btn');
            function displayReferences(filter) {
                referencesGrid.innerHTML = '';
                const data = filter === 'all' ? referencesData : referencesData.filter(i => i.category === filter);
                data.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card-flip min-h-[14rem] sm:min-h-[12rem]';
                    card.innerHTML = `<div class="card-inner"><div class="card-front bg-gray-800 border border-gray-700 p-2 text-center"><h4 class="text-lg font-bold text-white">${item.name}</h4><p class="text-sm text-blue-400">${item.source}</p></div><div class="card-back bg-gray-700 text-gray-200 p-2 flex flex-col justify-center"><p class="text-xs sm:text-sm leading-tight text-center">${item.explanation}</p>${item.punchline ? `<p class="mt-2 text-[10px] sm:text-xs italic opacity-70 text-center">${item.punchline}</p>` : ''}</div></div>`;
                    referencesGrid.appendChild(card);
                });
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => {
                        b.classList.remove('active', 'bg-blue-600', 'text-white');
                        b.classList.add('bg-gray-700', 'text-gray-300', 'hover:bg-gray-600');
                    });
                    btn.classList.add('active', 'bg-blue-600', 'text-white');
                    displayReferences(btn.dataset.filter);
                });
            });
            const initialFilter = document.querySelector('.filter-btn[data-filter="all"]');
            initialFilter.classList.add('active', 'bg-blue-600', 'text-white');
            displayReferences('all');

            const ctx = document.getElementById('styleChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Plugg', 'Mélodique', 'Introspectif', 'Électronique', 'Pop', 'Trap'],
                    datasets: [
                        { label: 'GARÇON (2022)', data: [9, 8, 9, 2, 3, 5], backgroundColor: 'rgba(59, 130, 246, 0.2)', borderColor: 'rgba(59, 130, 246, 1)', pointBackgroundColor: 'rgba(59, 130, 246, 1)', pointBorderColor: '#fff', borderWidth: 2 },
                        { label: 'EXIT (2024)', data: [2, 7, 8, 9, 8, 3], backgroundColor: 'rgba(239, 68, 68, 0.2)', borderColor: 'rgba(239, 68, 68, 1)', pointBackgroundColor: 'rgba(239, 68, 68, 1)', pointBorderColor: '#fff', borderWidth: 2 }
                    ]
                },
                options: {
                    maintainAspectRatio: false,
                    responsive: true,
                    scales: { r: { angleLines: { color: 'rgba(255, 255, 255, 0.2)' }, grid: { color: 'rgba(255, 255, 255, 0.2)' }, pointLabels: { font: { size: 12, weight: 'bold' }, color: '#D1D5DB' }, ticks: { backdropColor: 'transparent', color: '#9CA3AF' } } },
                    plugins: { legend: { labels: { color: '#D1D5DB', font: { size: 14 } } } }
                }
            });

            switchSection('introduction');
        });
    </script>
</body>
</html>
